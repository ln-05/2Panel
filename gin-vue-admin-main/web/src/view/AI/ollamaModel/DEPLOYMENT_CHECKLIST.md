# Ollama模型管理系统 - 部署检查清单

## 🔍 部署前检查

### 环境准备
- [ ] **Ollama服务已安装**
  ```bash
  ollama --version
  ```
- [ ] **Ollama服务正在运行**
  ```bash
  curl http://localhost:11434/api/tags
  ```
- [ ] **Go环境 (后端)**
  ```bash
  go version  # 需要 Go 1.19+
  ```
- [ ] **Node.js环境 (前端)**
  ```bash
  node --version  # 需要 Node.js 16+
  npm --version
  ```

### 数据库配置
- [ ] **MySQL数据库运行正常**
- [ ] **数据库连接配置正确** (`server/config.yaml`)
- [ ] **数据库表已创建** (自动迁移)

### 配置文件检查
- [ ] **后端配置** (`server/config.yaml`)
  - [ ] 数据库连接信息
  - [ ] Redis配置 (如果使用)
  - [ ] JWT密钥配置
  - [ ] 端口配置 (默认8888)

- [ ] **前端配置**
  - [ ] API基础URL配置
  - [ ] WebSocket URL配置

## 🚀 部署步骤

### 1. 后端部署
```bash
# 进入后端目录
cd server

# 安装依赖
go mod tidy

# 编译
go build -o main main.go

# 运行 (开发环境)
./main

# 或者直接运行
go run main.go
```

### 2. 前端部署
```bash
# 进入前端目录
cd web

# 安装依赖
npm install

# 开发环境运行
npm run dev

# 生产环境构建
npm run build
```

### 3. 服务验证
- [ ] **后端服务启动成功**
  ```bash
  curl http://localhost:8888/api/v1/ollamaModel/search
  ```

- [ ] **前端服务启动成功**
  ```bash
  # 访问 http://localhost:8080
  ```

- [ ] **WebSocket连接正常**
  ```bash
  # 检查浏览器控制台WebSocket连接状态
  ```

## ✅ 功能测试

### 基础功能测试
- [ ] **访问测试页面**: `http://localhost:8080/ollama-test`
- [ ] **API连接测试**: 点击"测试API连接"
- [ ] **WebSocket连接测试**: 点击"测试WebSocket连接"
- [ ] **进入主界面**: `http://localhost:8080/ollama`

### 模型管理测试
- [ ] **添加模型功能**
  - [ ] 打开添加模型对话框
  - [ ] 选择推荐模型 `phi:2.7b`
  - [ ] 开始下载
  - [ ] 验证下载状态更新

- [ ] **模型列表显示**
  - [ ] 模型信息正确显示
  - [ ] 状态实时更新
  - [ ] 搜索功能正常

- [ ] **模型操作**
  - [ ] 启动模型
  - [ ] 停止模型
  - [ ] 删除模型
  - [ ] 重建模型

### 对话功能测试
- [ ] **对话界面**
  - [ ] 打开AI对话对话框
  - [ ] 模型选择器正常工作
  - [ ] 只显示运行中的模型

- [ ] **对话功能**
  - [ ] 发送消息
  - [ ] 接收AI回复
  - [ ] 上下文保持
  - [ ] 清空对话

### 实时功能测试
- [ ] **WebSocket实时更新**
  - [ ] 模型状态变化实时显示
  - [ ] 连接状态指示器正常
  - [ ] 下载进度实时更新

## 🔧 性能检查

### 系统资源
- [ ] **内存使用**
  - [ ] 后端服务内存使用正常
  - [ ] 前端页面内存使用正常
  - [ ] Ollama服务内存使用正常

- [ ] **CPU使用**
  - [ ] 空闲时CPU使用率低
  - [ ] 对话时CPU使用率合理

- [ ] **网络连接**
  - [ ] API响应时间正常 (<1秒)
  - [ ] WebSocket连接稳定
  - [ ] 模型下载速度正常

### 并发测试
- [ ] **多用户访问**
  - [ ] 多个浏览器标签页同时访问
  - [ ] 多个用户同时对话
  - [ ] 系统稳定性良好

## 🛡️ 安全检查

### 访问控制
- [ ] **API权限验证**
  - [ ] 需要登录才能访问
  - [ ] 权限验证正常工作

- [ ] **输入验证**
  - [ ] 模型名称格式验证
  - [ ] 对话输入长度限制
  - [ ] SQL注入防护

### 数据安全
- [ ] **敏感信息保护**
  - [ ] 配置文件中的密码已加密
  - [ ] 日志中不包含敏感信息

## 📊 监控配置

### 日志监控
- [ ] **应用日志**
  - [ ] 后端日志正常输出
  - [ ] 错误日志记录完整
  - [ ] 日志轮转配置

- [ ] **系统日志**
  - [ ] Ollama服务日志
  - [ ] 系统资源监控

### 告警配置
- [ ] **服务状态监控**
  - [ ] 后端服务健康检查
  - [ ] Ollama服务状态监控
  - [ ] 数据库连接监控

## 🚨 故障恢复

### 备份策略
- [ ] **数据库备份**
  - [ ] 定期数据备份
  - [ ] 备份恢复测试

- [ ] **配置备份**
  - [ ] 配置文件备份
  - [ ] 部署脚本备份

### 恢复测试
- [ ] **服务重启测试**
  - [ ] 后端服务重启恢复
  - [ ] 前端服务重启恢复
  - [ ] Ollama服务重启恢复

- [ ] **故障切换测试**
  - [ ] 数据库连接失败处理
  - [ ] Ollama服务不可用处理
  - [ ] WebSocket连接断开处理

## 📋 生产环境配置

### 性能优化
- [ ] **前端优化**
  - [ ] 代码压缩和混淆
  - [ ] 静态资源CDN
  - [ ] 缓存策略配置

- [ ] **后端优化**
  - [ ] 数据库连接池配置
  - [ ] Redis缓存配置
  - [ ] API限流配置

### 安全加固
- [ ] **HTTPS配置**
  - [ ] SSL证书配置
  - [ ] 强制HTTPS重定向

- [ ] **防火墙配置**
  - [ ] 只开放必要端口
  - [ ] IP白名单配置

## ✅ 部署完成确认

### 最终验证
- [ ] **完整功能流程测试**
  1. 访问系统
  2. 添加模型
  3. 启动模型
  4. 进行对话
  5. 管理模型

- [ ] **性能指标确认**
  - [ ] 响应时间 < 2秒
  - [ ] 内存使用 < 80%
  - [ ] CPU使用 < 70%

- [ ] **稳定性确认**
  - [ ] 连续运行24小时无异常
  - [ ] 多用户并发测试通过
  - [ ] 异常恢复测试通过

### 文档交付
- [ ] **用户文档**
  - [ ] 快速启动指南
  - [ ] 使用说明文档
  - [ ] 故障排除指南

- [ ] **运维文档**
  - [ ] 部署文档
  - [ ] 监控配置
  - [ ] 备份恢复流程

---

## 🎉 部署成功！

当所有检查项都完成后，您的Ollama模型管理系统就可以正式投入使用了！

**系统访问地址**:
- 主界面: `http://localhost:8080/ollama`
- 测试页面: `http://localhost:8080/ollama-test`

**下一步建议**:
1. 根据实际使用情况调整系统配置
2. 定期监控系统性能和稳定性
3. 根据用户反馈持续优化功能
4. 定期更新Ollama和模型版本